<!DOCTYPE html>
<html lang="th" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Learn — สมัครสมาชิก</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        background: '#0B1120',
                        surface: '#1E293B',
                        primary: '#38bdf8',
                        secondary: '#818cf8',
                        accent: '#2dd4bf'
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .bg-grid {
            background-size: 40px 40px;
            background-image: linear-gradient(to right, rgba(255, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255, 255, 255, 0.02) 1px, transparent 1px);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-6px);
            }
        }

        @keyframes pulseGlow {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(129, 140, 248, 0.15);
            }

            50% {
                box-shadow: 0 0 40px rgba(129, 140, 248, 0.3);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        @keyframes orbit {
            from {
                transform: rotate(0deg) translateX(140px) rotate(0deg);
            }

            to {
                transform: rotate(360deg) translateX(140px) rotate(-360deg);
            }
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out both;
        }

        .card-glow {
            animation: pulseGlow 4s ease-in-out infinite;
        }

        .logo-float {
            animation: float 4s ease-in-out infinite;
        }

        .orbit-dot {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            margin: -3px;
        }

        .orbit-1 {
            animation: orbit 14s linear infinite;
            background: #818cf8;
            opacity: 0.4;
        }

        .orbit-2 {
            animation: orbit 20s linear infinite reverse;
            background: #38bdf8;
            opacity: 0.3;
        }

        .orbit-3 {
            animation: orbit 28s linear infinite;
            background: #2dd4bf;
            opacity: 0.2;
        }

        .btn-shimmer {
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        input:-webkit-autofill {
            -webkit-box-shadow: 0 0 0 30px #1E293B inset !important;
            -webkit-text-fill-color: #e2e8f0 !important;
        }

        .password-strength {
            transition: width 0.3s ease, background 0.3s ease;
        }
    </style>
</head>

<body class="bg-background text-slate-400 antialiased min-h-screen flex items-center justify-center overflow-hidden">
    <!-- Background effects -->
    <div class="fixed inset-0 bg-grid pointer-events-none z-0"></div>
    <div
        class="fixed top-1/3 right-1/4 w-[600px] h-[600px] bg-indigo-500/5 blur-[150px] rounded-full pointer-events-none z-0">
    </div>
    <div
        class="fixed bottom-1/3 left-1/4 w-[500px] h-[500px] bg-sky-500/5 blur-[150px] rounded-full pointer-events-none z-0">
    </div>

    <!-- Orbit ring decoration -->
    <div
        class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[280px] h-[280px] rounded-full border border-slate-800/30 pointer-events-none z-0">
    </div>
    <div class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none z-0">
        <div class="orbit-dot orbit-1"></div>
        <div class="orbit-dot orbit-2"></div>
        <div class="orbit-dot orbit-3"></div>
    </div>

    <!-- Register Card -->
    <div class="relative z-10 w-full max-w-md px-4 fade-in">
        <div class="bg-slate-900/70 backdrop-blur-2xl border border-slate-800 rounded-3xl p-8 shadow-2xl card-glow">

            <!-- Logo -->
            <div class="flex flex-col items-center mb-6">
                <div
                    class="w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-violet-500 flex items-center justify-center shadow-xl shadow-indigo-500/20 logo-float mb-4">
                    <i data-lucide="user-plus" class="w-8 h-8 text-white"></i>
                </div>
                <h1 class="text-2xl font-bold text-slate-100 tracking-tight">สมัครสมาชิก</h1>
                <p class="text-sm text-slate-500 mt-1">สร้างบัญชีเพื่อเข้าสู่ Galaxy แห่งการเรียนรู้</p>
            </div>

            <!-- Error message -->
            <div id="errorMsg"
                class="hidden mb-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 text-sm flex items-center gap-2">
                <i data-lucide="alert-circle" class="w-4 h-4 shrink-0"></i>
                <span id="errorText"></span>
            </div>

            <!-- Form -->
            <form id="registerForm" class="space-y-4">
                <!-- Name -->
                <div>
                    <label
                        class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1.5">ชื่อ-นามสกุล</label>
                    <div class="relative">
                        <i data-lucide="user"
                            class="w-4 h-4 text-slate-500 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none"></i>
                        <input type="text" id="name" required placeholder="John Doe"
                            class="w-full pl-10 pr-4 py-3 rounded-xl bg-slate-800/80 border border-slate-700 text-slate-200 text-sm placeholder:text-slate-600 focus:outline-none focus:border-secondary/50 focus:ring-1 focus:ring-secondary/20 transition-all">
                    </div>
                </div>

                <!-- Email -->
                <div>
                    <label
                        class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1.5">Email</label>
                    <div class="relative">
                        <i data-lucide="mail"
                            class="w-4 h-4 text-slate-500 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none"></i>
                        <input type="email" id="email" required placeholder="you@example.com"
                            class="w-full pl-10 pr-4 py-3 rounded-xl bg-slate-800/80 border border-slate-700 text-slate-200 text-sm placeholder:text-slate-600 focus:outline-none focus:border-secondary/50 focus:ring-1 focus:ring-secondary/20 transition-all">
                    </div>
                </div>

                <!-- Password -->
                <div>
                    <label
                        class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1.5">รหัสผ่าน</label>
                    <div class="relative">
                        <i data-lucide="lock"
                            class="w-4 h-4 text-slate-500 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none"></i>
                        <input type="password" id="password" required placeholder="อย่างน้อย 6 ตัวอักษร" minlength="6"
                            class="w-full pl-10 pr-4 py-3 rounded-xl bg-slate-800/80 border border-slate-700 text-slate-200 text-sm placeholder:text-slate-600 focus:outline-none focus:border-secondary/50 focus:ring-1 focus:ring-secondary/20 transition-all">
                    </div>
                    <!-- Password strength -->
                    <div class="mt-2 h-1 bg-slate-800 rounded-full overflow-hidden">
                        <div id="passwordStrength" class="password-strength h-full rounded-full w-0"></div>
                    </div>
                    <p id="passwordHint" class="text-[10px] text-slate-600 mt-1">อย่างน้อย 6 ตัวอักษร</p>
                </div>

                <!-- Confirm Password -->
                <div>
                    <label
                        class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1.5">ยืนยันรหัสผ่าน</label>
                    <div class="relative">
                        <i data-lucide="shield-check"
                            class="w-4 h-4 text-slate-500 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none"></i>
                        <input type="password" id="confirmPassword" required placeholder="กรอกรหัสผ่านอีกครั้ง"
                            class="w-full pl-10 pr-4 py-3 rounded-xl bg-slate-800/80 border border-slate-700 text-slate-200 text-sm placeholder:text-slate-600 focus:outline-none focus:border-secondary/50 focus:ring-1 focus:ring-secondary/20 transition-all">
                    </div>
                    <p id="matchHint" class="text-[10px] mt-1 hidden"></p>
                </div>

                <!-- Terms -->
                <label class="flex items-start gap-2.5 cursor-pointer">
                    <input type="checkbox" id="terms" required
                        class="w-3.5 h-3.5 mt-0.5 rounded border-slate-600 bg-slate-800 text-secondary focus:ring-secondary/20">
                    <span class="text-xs text-slate-500 leading-relaxed">
                        ฉันยอมรับ <a href="#" class="text-secondary hover:underline">เงื่อนไขการใช้งาน</a> และ
                        <a href="#" class="text-secondary hover:underline">นโยบายความเป็นส่วนตัว</a>
                    </span>
                </label>

                <!-- Register Button -->
                <button type="submit" id="registerBtn"
                    class="relative w-full py-3 rounded-xl bg-gradient-to-r from-indigo-500 to-violet-500 text-white font-semibold text-sm shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 hover:scale-[1.02] active:scale-[0.98] transition-all overflow-hidden">
                    <span id="registerBtnText" class="relative z-10 flex items-center justify-center gap-2">
                        <i data-lucide="rocket" class="w-4 h-4"></i>
                        สร้างบัญชี
                    </span>
                    <div class="absolute inset-0 btn-shimmer pointer-events-none"></div>
                </button>
            </form>

            <!-- Divider -->
            <div class="flex items-center gap-3 my-6">
                <div class="flex-1 h-px bg-slate-800"></div>
                <span class="text-[10px] text-slate-600 uppercase tracking-widest">หรือ</span>
                <div class="flex-1 h-px bg-slate-800"></div>
            </div>

            <!-- Login link -->
            <div class="text-center">
                <p class="text-sm text-slate-500">
                    มีบัญชีอยู่แล้ว?
                    <a href="mockup_login.html" class="text-secondary font-medium hover:underline">เข้าสู่ระบบ</a>
                </p>
            </div>
        </div>

        <!-- Footer -->
        <p class="text-center text-[10px] text-slate-700 mt-6">
            ANLP-GSM · AI-Native Adaptive Learning Platform · v2.0
        </p>
    </div>

    <script>
        lucide.createIcons();

        // API Base URL
        const API_BASE = window.location.port === ''
            ? 'http://localhost:3000'
            : `${window.location.protocol}//${window.location.hostname}:3000`;

        // Password strength indicator
        document.getElementById('password').addEventListener('input', (e) => {
            const val = e.target.value;
            const bar = document.getElementById('passwordStrength');
            const hint = document.getElementById('passwordHint');
            let strength = 0;

            if (val.length >= 6) strength++;
            if (val.length >= 8) strength++;
            if (/[A-Z]/.test(val)) strength++;
            if (/[0-9]/.test(val)) strength++;
            if (/[^A-Za-z0-9]/.test(val)) strength++;

            const pct = (strength / 5) * 100;
            bar.style.width = pct + '%';

            if (strength <= 1) { bar.style.background = '#ef4444'; hint.textContent = 'อ่อนมาก'; hint.className = 'text-[10px] text-red-400 mt-1'; }
            else if (strength <= 2) { bar.style.background = '#f97316'; hint.textContent = 'อ่อน'; hint.className = 'text-[10px] text-orange-400 mt-1'; }
            else if (strength <= 3) { bar.style.background = '#eab308'; hint.textContent = 'ปานกลาง'; hint.className = 'text-[10px] text-yellow-400 mt-1'; }
            else if (strength <= 4) { bar.style.background = '#22c55e'; hint.textContent = 'แข็งแรง'; hint.className = 'text-[10px] text-green-400 mt-1'; }
            else { bar.style.background = '#2dd4bf'; hint.textContent = 'แข็งแรงมาก'; hint.className = 'text-[10px] text-accent mt-1'; }

            if (val.length === 0) { bar.style.width = '0'; hint.textContent = 'อย่างน้อย 6 ตัวอักษร'; hint.className = 'text-[10px] text-slate-600 mt-1'; }
        });

        // Confirm password match
        document.getElementById('confirmPassword').addEventListener('input', (e) => {
            const pass = document.getElementById('password').value;
            const confirm = e.target.value;
            const hint = document.getElementById('matchHint');

            if (confirm.length === 0) { hint.classList.add('hidden'); return; }

            hint.classList.remove('hidden');
            if (pass === confirm) {
                hint.textContent = '✓ รหัสผ่านตรงกัน';
                hint.className = 'text-[10px] text-green-400 mt-1';
            } else {
                hint.textContent = '✗ รหัสผ่านไม่ตรงกัน';
                hint.className = 'text-[10px] text-red-400 mt-1';
            }
        });

        // Handle register
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            hideMessages();

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const btn = document.getElementById('registerBtn');
            const btnText = document.getElementById('registerBtnText');

            // Validate
            if (password !== confirmPassword) {
                showError('รหัสผ่านไม่ตรงกัน');
                return;
            }

            if (password.length < 6) {
                showError('รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร');
                return;
            }

            // Loading state
            btn.disabled = true;
            btnText.innerHTML = '<svg class="animate-spin w-4 h-4" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/></svg> กำลังสร้างบัญชี...';

            try {
                const res = await fetch(`${API_BASE}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password })
                });

                const data = await res.json();

                if (!res.ok) {
                    throw new Error(data.error || 'สมัครสมาชิกไม่สำเร็จ');
                }

                // Redirect to login with success message
                window.location.href = 'mockup_login.html?registered=true';

            } catch (err) {
                showError(err.message);
                btn.disabled = false;
                btnText.innerHTML = '<i data-lucide="rocket" class="w-4 h-4"></i> สร้างบัญชี';
                lucide.createIcons();
            }
        });

        function showError(msg) {
            const el = document.getElementById('errorMsg');
            document.getElementById('errorText').textContent = msg;
            el.classList.remove('hidden');
        }

        function hideMessages() {
            document.getElementById('errorMsg').classList.add('hidden');
        }
    </script>
</body>

</html>